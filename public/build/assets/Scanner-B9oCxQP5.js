import{r as i,j as e,H as L,L as v,a as E}from"./app-AeXxRj49.js";import{A as I,X as M}from"./app-layout-DK0yK9nT.js";import{B as m}from"./button-DEZ6P0Xw.js";import{I as u}from"./input-DfaFL0Ps.js";import{L as x}from"./label-BHhOMbqT.js";import{U as y,S as B,a as G,b as K,c as O,d as $}from"./select-B_pqGwLX.js";import{C as w,a as S,A as z,b as H,c as J}from"./alert-6IcD1m-0.js";import{C as R}from"./chevron-left-wogbF7sm.js";import{C as D}from"./check-D7Gr2vb-.js";import{F as V}from"./file-text-C5gOPu4k.js";import{C as Y}from"./circle-alert-DbweJayW.js";import{L as X}from"./loader-circle-aEuAwtPY.js";/* empty css            */import"./index-CmViNOhO.js";import"./index-CAR0PBSa.js";import"./index-CCPXPrVd.js";import"./index-DHiOS5df.js";const q=[{title:"Beranda",href:"/dashboard"},{title:"Unggah Arsip",href:"/scanner"}];function he({categories:C=[]}){const[r,o]=i.useState(null),[k,p]=i.useState(!1),[d,f]=i.useState(!1),[F,h]=i.useState("idle"),[j,n]=i.useState(""),[s,l]=i.useState({title:"",year:new Date().getFullYear().toString(),uploaded_at:new Date().toISOString().split("T")[0],category_id:""}),b=i.useRef(null),g=a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?p(!0):a.type==="dragleave"&&p(!1)},A=a=>{a.preventDefault(),a.stopPropagation(),p(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&N(a.dataTransfer.files[0])},T=a=>{a.preventDefault(),a.target.files&&a.target.files[0]&&N(a.target.files[0])},N=a=>{const t=["application/pdf","image/jpeg","image/png","image/jpg"];if(a.size>10*1024*1024){n("Ukuran file melebihi batas 10MB.");return}if(t.includes(a.type)){if(o(a),n(""),!s.title){const c=a.name.split(".").slice(0,-1).join(".");l(U=>({...U,title:c}))}}else n("Format file tidak didukung. Harap unggah PDF atau Gambar (JPG/PNG).")},_=async()=>{if(!(!r||!s.title||!s.category_id)){f(!0),n("");try{const a=new FormData;a.append("file",r),a.append("title",s.title),a.append("year",s.year),s.uploaded_at&&a.append("uploaded_at",s.uploaded_at),a.append("category_id",s.category_id),await E.post("/api/archives",a,{headers:{"Content-Type":"multipart/form-data"}}),h("success"),o(null),l(t=>({...t,title:"",year:t.year}))}catch(a){console.error(a),h("error");let t="Gagal mengunggah file. Silakan coba lagi.";if(a.response&&a.response.data)if(a.response.data.message){if(t=`Error: ${a.response.data.message}`,a.response.data.errors){const c=Object.values(a.response.data.errors)[0];Array.isArray(c)&&(t+=` (${c[0]})`)}}else a.response.data.error&&(t=`Server Error: ${a.response.data.error}`);n(t)}finally{f(!1)}}},P=()=>{h("idle"),o(null),n(""),l({title:"",year:new Date().getFullYear().toString(),uploaded_at:new Date().toISOString().split("T")[0],category_id:""})};return e.jsxs(I,{breadcrumbs:q,children:[e.jsx(L,{title:"Unggah Arsip"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4 md:p-8 max-w-5xl mx-auto w-full font-sans",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(v,{href:"/dashboard",className:"flex h-12 w-12 items-center justify-center rounded-xl bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors",children:e.jsx(R,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-slate-900",children:"Unggah Arsip Digital"}),e.jsx("p",{className:"text-sm md:text-base text-slate-500",children:"Unggah dokumen PDF atau gambar ke dalam sistem arsip."})]})]})}),F==="success"?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center bg-white rounded-[2rem] border border-slate-100 shadow-sm animate-in fade-in zoom-in duration-300",children:[e.jsx("div",{className:"h-24 w-24 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(D,{className:"h-12 w-12"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Arsip Berhasil Disimpan!"}),e.jsx("p",{className:"text-slate-500 mb-8 max-w-md",children:"Dokumen telah berhasil diunggah dan disimpan ke dalam database arsip digital."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(v,{href:"/dashboard",children:e.jsx(m,{variant:"outline",className:"rounded-xl h-12 px-6",children:"Kembali ke Dashboard"})}),e.jsx(m,{onClick:P,className:"rounded-xl h-12 px-8 bg-blue-600 hover:bg-blue-700",children:"Unggah Lagi"})]})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"space-y-6",children:e.jsx(w,{className:"border-0 shadow-lg rounded-[2rem] overflow-hidden",children:e.jsxs(S,{className:"p-6 md:p-8",children:[e.jsxs("div",{className:`relative border-3 border-dashed rounded-[1.5rem] transition-all duration-200 text-center p-8 md:p-12 flex flex-col items-center justify-center gap-4 cursor-pointer
                                            ${k?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}
                                            ${r?"bg-emerald-50 border-emerald-200":""}
                                        `,onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:A,onClick:()=>b.current?.click(),children:[e.jsx("input",{ref:b,type:"file",className:"hidden",accept:"application/pdf,image/jpeg,image/png,image/jpg",onChange:T}),r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-20 w-20 rounded-2xl bg-emerald-100 flex items-center justify-center text-emerald-600 mb-2",children:e.jsx(V,{className:"h-10 w-10"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800 text-lg break-all",children:r.name}),e.jsxs("p",{className:"text-slate-500 text-sm",children:[(r.size/1024/1024).toFixed(2)," MB"]})]}),e.jsx(m,{variant:"ghost",size:"sm",className:"absolute top-4 right-4 text-slate-400 hover:text-red-500 hover:bg-red-50",onClick:a=>{a.stopPropagation(),o(null)},children:e.jsx(M,{className:"h-5 w-5"})}),e.jsxs("div",{className:"absolute bottom-4 text-emerald-600 text-sm font-medium flex items-center gap-1",children:[e.jsx(D,{className:"h-4 w-4"})," Siap diunggah"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-20 w-20 rounded-2xl bg-blue-100 flex items-center justify-center text-blue-600 mb-2",children:e.jsx(y,{className:"h-10 w-10"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-bold text-slate-800 text-lg",children:"Klik atau Tarik File Di Sini"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Mendukung PDF, JPG, PNG (Max 10MB)"})]})]})]}),j&&e.jsxs(z,{variant:"destructive",className:"mt-4 rounded-xl",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx(H,{children:"Error"}),e.jsx(J,{children:j})]})]})})}),e.jsx("div",{className:"space-y-6",children:e.jsx(w,{className:"border-0 shadow-lg rounded-[2rem] overflow-hidden h-fit",children:e.jsxs(S,{className:"p-6 md:p-8 space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Detail Arsip"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"title",className:"text-slate-600",children:["Judul Dokumen ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{id:"title",placeholder:"Contoh: Surat Keputusan...",value:s.title,onChange:a=>l({...s,title:a.target.value}),className:"h-12 rounded-xl",disabled:d})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"year",className:"text-slate-600",children:["Tahun ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{id:"year",type:"number",value:s.year,onChange:a=>l({...s,year:a.target.value}),className:"h-12 rounded-xl",disabled:d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"uploaded_at",className:"text-slate-600",children:"Tanggal Arsip"}),e.jsx(u,{id:"uploaded_at",type:"date",value:s.uploaded_at||new Date().toISOString().split("T")[0],onChange:a=>l({...s,uploaded_at:a.target.value}),className:"h-12 rounded-xl",disabled:d})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"category",className:"text-slate-600",children:["Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(B,{value:s.category_id,onValueChange:a=>l({...s,category_id:a}),disabled:d,children:[e.jsx(G,{className:"h-12 rounded-xl",children:e.jsx(K,{placeholder:"Pilih Kategori"})}),e.jsx(O,{children:C.map(a=>e.jsx($,{value:a.id.toString(),children:a.name},a.id))})]})]})]}),e.jsx(m,{className:"w-full h-14 text-lg font-bold rounded-xl bg-blue-600 hover:bg-blue-700 shadow-lg mt-4 disabled:opacity-50",onClick:_,disabled:!r||!s.title||!s.category_id||d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-2 h-5 w-5 animate-spin"})," Mengunggah..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-5 w-5"})," Simpan Arsip"]})})]})})})]})]})]})}export{he as default};
