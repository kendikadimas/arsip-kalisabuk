import{r,j as e,H as U,L as N,a as I}from"./app-DcP0g6Nw.js";import{A as M,X as B}from"./app-layout-CBEerPHF.js";import{B as o}from"./button-DtSP9Ro0.js";import{I as g}from"./input-Vxwv_GHT.js";import{L as c}from"./label-B_nBB3AB.js";import{U as v,S as G,a as E,b as K,c as O,d as z}from"./select-CzF4nYq2.js";import{C as y,a as w,A as H,b as J,c as R}from"./alert-CuRR5bcZ.js";import{C as V}from"./chevron-left-D7Efthc4.js";import{C as D}from"./check-BF7fnVQN.js";import{F as Y}from"./file-text-DlUnHqbG.js";import{C as $}from"./circle-alert-BpfEUtz5.js";import{L as X}from"./loader-circle-D4Fzot3l.js";/* empty css            */import"./index-DjwN6TEK.js";import"./index-C1WLQvrf.js";import"./index-Dg3ewEdB.js";import"./index-qjl_y151.js";const q=[{title:"Beranda",href:"/dashboard"},{title:"Unggah Arsip",href:"/scanner"}];function pe({categories:S=[]}){const[t,n]=r.useState(null),[C,m]=r.useState(!1),[i,u]=r.useState(!1),[k,x]=r.useState("idle"),[f,d]=r.useState(""),[s,l]=r.useState({title:"",year:new Date().getFullYear().toString(),uploaded_at:new Date().toISOString().split("T")[0],category_id:""}),j=r.useRef(null),h=a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?m(!0):a.type==="dragleave"&&m(!1)},F=a=>{a.preventDefault(),a.stopPropagation(),m(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&b(a.dataTransfer.files[0])},A=a=>{a.preventDefault(),a.target.files&&a.target.files[0]&&b(a.target.files[0])},b=a=>{if(["application/pdf","image/jpeg","image/png","image/jpg"].includes(a.type)){if(n(a),d(""),!s.title){const P=a.name.split(".").slice(0,-1).join(".");l(L=>({...L,title:P}))}}else d("Format file tidak didukung. Harap unggah PDF atau Gambar (JPG/PNG).")},T=async()=>{if(!(!t||!s.title||!s.category_id)){u(!0),d("");try{const a=new FormData;a.append("file",t),a.append("title",s.title),a.append("year",s.year),s.uploaded_at&&a.append("uploaded_at",s.uploaded_at),a.append("category_id",s.category_id),await I.post("/api/archives",a,{headers:{"Content-Type":"multipart/form-data"}}),x("success"),n(null),l(p=>({...p,title:"",year:p.year}))}catch(a){console.error(a),x("error"),d("Gagal mengunggah file. Silakan coba lagi.")}finally{u(!1)}}},_=()=>{x("idle"),n(null),d(""),l({title:"",year:new Date().getFullYear().toString(),uploaded_at:new Date().toISOString().split("T")[0],category_id:""})};return e.jsxs(M,{breadcrumbs:q,children:[e.jsx(U,{title:"Unggah Arsip"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4 md:p-8 max-w-5xl mx-auto w-full font-sans",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(N,{href:"/dashboard",className:"flex h-12 w-12 items-center justify-center rounded-xl bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors",children:e.jsx(V,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-slate-900",children:"Unggah Arsip Digital"}),e.jsx("p",{className:"text-sm md:text-base text-slate-500",children:"Unggah dokumen PDF atau gambar ke dalam sistem arsip."})]})]})}),k==="success"?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center bg-white rounded-[2rem] border border-slate-100 shadow-sm animate-in fade-in zoom-in duration-300",children:[e.jsx("div",{className:"h-24 w-24 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(D,{className:"h-12 w-12"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Arsip Berhasil Disimpan!"}),e.jsx("p",{className:"text-slate-500 mb-8 max-w-md",children:"Dokumen telah berhasil diunggah dan disimpan ke dalam database arsip digital."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(N,{href:"/dashboard",children:e.jsx(o,{variant:"outline",className:"rounded-xl h-12 px-6",children:"Kembali ke Dashboard"})}),e.jsx(o,{onClick:_,className:"rounded-xl h-12 px-8 bg-blue-600 hover:bg-blue-700",children:"Unggah Lagi"})]})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"space-y-6",children:e.jsx(y,{className:"border-0 shadow-lg rounded-[2rem] overflow-hidden",children:e.jsxs(w,{className:"p-6 md:p-8",children:[e.jsxs("div",{className:`relative border-3 border-dashed rounded-[1.5rem] transition-all duration-200 text-center p-8 md:p-12 flex flex-col items-center justify-center gap-4 cursor-pointer
                                            ${C?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}
                                            ${t?"bg-emerald-50 border-emerald-200":""}
                                        `,onDragEnter:h,onDragLeave:h,onDragOver:h,onDrop:F,onClick:()=>j.current?.click(),children:[e.jsx("input",{ref:j,type:"file",className:"hidden",accept:"application/pdf,image/jpeg,image/png,image/jpg",onChange:A}),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-20 w-20 rounded-2xl bg-emerald-100 flex items-center justify-center text-emerald-600 mb-2",children:e.jsx(Y,{className:"h-10 w-10"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800 text-lg break-all",children:t.name}),e.jsxs("p",{className:"text-slate-500 text-sm",children:[(t.size/1024/1024).toFixed(2)," MB"]})]}),e.jsx(o,{variant:"ghost",size:"sm",className:"absolute top-4 right-4 text-slate-400 hover:text-red-500 hover:bg-red-50",onClick:a=>{a.stopPropagation(),n(null)},children:e.jsx(B,{className:"h-5 w-5"})}),e.jsxs("div",{className:"absolute bottom-4 text-emerald-600 text-sm font-medium flex items-center gap-1",children:[e.jsx(D,{className:"h-4 w-4"})," Siap diunggah"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-20 w-20 rounded-2xl bg-blue-100 flex items-center justify-center text-blue-600 mb-2",children:e.jsx(v,{className:"h-10 w-10"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-bold text-slate-800 text-lg",children:"Klik atau Tarik File Di Sini"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Mendukung PDF, JPG, PNG (Max 10MB)"})]})]})]}),f&&e.jsxs(H,{variant:"destructive",className:"mt-4 rounded-xl",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx(J,{children:"Error"}),e.jsx(R,{children:f})]})]})})}),e.jsx("div",{className:"space-y-6",children:e.jsx(y,{className:"border-0 shadow-lg rounded-[2rem] overflow-hidden h-fit",children:e.jsxs(w,{className:"p-6 md:p-8 space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Detail Arsip"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"title",className:"text-slate-600",children:["Judul Dokumen ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(g,{id:"title",placeholder:"Contoh: Surat Keputusan...",value:s.title,onChange:a=>l({...s,title:a.target.value}),className:"h-12 rounded-xl",disabled:i})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"year",className:"text-slate-600",children:["Tahun ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(g,{id:"year",type:"number",value:s.year,onChange:a=>l({...s,year:a.target.value}),className:"h-12 rounded-xl",disabled:i})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"uploaded_at",className:"text-slate-600",children:"Tanggal Arsip"}),e.jsx(g,{id:"uploaded_at",type:"date",value:s.uploaded_at||new Date().toISOString().split("T")[0],onChange:a=>l({...s,uploaded_at:a.target.value}),className:"h-12 rounded-xl",disabled:i})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"category",className:"text-slate-600",children:["Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(G,{value:s.category_id,onValueChange:a=>l({...s,category_id:a}),disabled:i,children:[e.jsx(E,{className:"h-12 rounded-xl",children:e.jsx(K,{placeholder:"Pilih Kategori"})}),e.jsx(O,{children:S.map(a=>e.jsx(z,{value:a.id.toString(),children:a.name},a.id))})]})]})]}),e.jsx(o,{className:"w-full h-14 text-lg font-bold rounded-xl bg-blue-600 hover:bg-blue-700 shadow-lg mt-4 disabled:opacity-50",onClick:T,disabled:!t||!s.title||!s.category_id||i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-2 h-5 w-5 animate-spin"})," Mengunggah..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2 h-5 w-5"})," Simpan Arsip"]})})]})})})]})]})]})}export{pe as default};
